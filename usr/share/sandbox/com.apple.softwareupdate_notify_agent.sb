;; Copyright (c) 2012 Apple Inc.  All Rights reserved.
;;
;; profile for com.apple.softwareupdate_notify_agent
;;
;; WARNING: The sandbox rules in this file currently constitute 
;; Apple System Private Interface and are subject to change at any time and
;; without notice.
;;

(version 1)
(deny default)
(import "system.sb")

(allow mach-lookup
       (global-name "com.apple.PowerManagement.control")
       (global-name "com.apple.softwareupdated")
       (global-name "com.apple.appstoreupdateagent")
       (global-name "com.apple.distributed_notifications@Uv3")
       (global-name "com.apple.system.logger")
       (global-name "com.apple.distributed_notifications@Uv3")
       (global-name "com.apple.distributed_notifications@1v3"))

(allow file-read*
       (literal "/Library/Preferences/com.apple.SoftwareUpdate.plist")
       (literal "/private/var/db/SUPrefOverrides.plist")
       (regex #"/.GlobalPreferences[^/]*\.plist")
       (regex #"/Library/Preferences/com\.apple\.systempreferences\.plist$")
       (literal "/Library/Application Support/CrashReporter/SubmitDiagInfo.domains")
       (literal "/Library/Caches/com.apple.DiagnosticReporting.HasBeenAppleInternal")
       (subpath "/Library/Bundles"))

(allow file-read-metadata)

(allow user-preference-read user-preference-write
       (preference-domain "com.apple.systempreferences")
       (preference-domain "com.apple.preferences.softwareupdate"))

(allow user-preference-read
       (preference-domain "com.apple.commerce"))

(allow file-read*
       (literal "/Library/Preferences/.GlobalPreferences.plist")
       (regex #"^/Library/Preferences/\.GlobalPreferences\.plist")
       (regex #"^/private/var/root/Library/Preferences/\.GlobalPreferences\.plist")
       (regex #"^/private/var/root/Library/Preferences/ByHost/\.GlobalPreferences\."))

